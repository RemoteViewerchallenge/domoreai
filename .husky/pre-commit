

# 1. Get current branch name
branch_name=$(git symbolic-ref --short HEAD)

# 2. Check Branch Naming (Skip for main)
if [ "$branch_name" != "main" ]; then
  if ! echo "$branch_name" | grep -qE '^(feature|fix|chore|hotfix|release)/[a-z0-9._-]+$'; then
    echo "âŒ Error: Invalid branch name '$branch_name'."
    echo "   Branch names must follow the format: type/description"
    echo "   Allowed types: feature, fix, chore, hotfix, release"
    echo "   Description: lowercase alphanumeric, dots, underscores, or hyphens."
    echo "   Example: feature/new-login-page"
    exit 1
  fi
fi

# 3. Run Linting (Staged files only)
echo "ğŸ” Running Lint on staged files..."
npx lint-staged
if [ $? -ne 0 ]; then
  echo "âŒ Error: Linting failed."
  exit 1
fi

# 4. Run Build
echo "ğŸ—ï¸ Running Build..."
pnpm run build
if [ $? -ne 0 ]; then
  echo "âŒ Error: Build failed."
  exit 1
fi

echo "âœ… Pre-commit checks passed!"
